![](https://dev.lutece.paris.fr/jenkins/buildStatus/icon?job=plugin-cgu-deploy)
# Plugin cgu

## Introduction

Ce plugin permet de g&eacute;rer des Conditions G&eacute;n&eacute;rales d'Utilisations (CGU). Une CGU peut avoir plusieurs versions. Une version reste modifiable et n'est pas visible en front-office tant qu'elle n'est pas publi&eacute;e.

## Configuration

Le plugin ajoute la page d'admin **Gestion des CGU** qui permet de g&eacute;rer les CGU. Les CGU cr&eacute;&eacute;es sont alors affich&eacute;es. Seules les 2 derni&egrave;res versions des CGU sont affich&eacute;es : la version draft et la derni&egrave;re version publi&eacute;e. Pour voir l'ensemble des versions d'une CGU, il suffit de cliquer sur le bouton **Voir les versions pr&eacute;c&eacute;dentes** de la colonne **Actions** .

L'administrateur peut effectuer les actions suivantes :
 
*  **Ajouter une CGU** . Elle s'ajoutera alors&agrave; la liste des CGU.
*  **Modifier** une CGU. Seule la version draft d'une CGU peut&ecirc;tre&eacute;dit&eacute;e.
*  **Publier version** . La version en question sera alors disponible en front-office. Seule la derni&egrave;re version publi&eacute;e est disponible en front-office. Une nouvelle version draft est alors automatiquement cr&eacute;&eacute;e.
*  **Voir les versions pr&eacute;c&eacute;dentes** . Les versions pr&eacute;c&eacute;dentes s'affichent alors sous la derni&egrave;re version publi&eacute;e.
*  **Pr&eacute;visualisation du texte** . La pr&eacute;visualisation de la CGU s'affiche alors dans un nouvel onglet. Le rendu est celui affich&eacute; en appliquant les classes CSS renseign&eacute;es.


Lors de la cr&eacute;ation d'une CGU, les champs suivants sont&agrave; renseigner :
 
*  **Description** : champ&agrave; destination des administrateurs pour qu'ils puissent s'y retrouver parmi la liste des CGU.
*  **Code CGU** : code unique parmi les CGU. Ce code est utilis&eacute; par les autres plugins Lutece pour retrouver la bonne CGU.
*  **Age minimum** : l'&acirc;ge minimum requis pour accepter la CGU. Si la valeur est inf&eacute;rieure ou&eacute;gale&agrave; 0, alors il n'y a pas de limite d'&acirc;ge.
*  **Texte** : texte de la CGU. Ce texte peut contenir du HTML.
*  **Feuille de style** : classes CSS en lien avec le HTML du champ **Texte** . Champ facultatif.


Tous ces&eacute;l&eacute;ments peuvent&ecirc;tre diff&eacute;rents d'une version&agrave; l'autre. **Attention :** La modification des champs **Description** et **Code CGU** s'applique&agrave; l'ensemble des versions de la CGU.

## Services

Le service `fr.paris.lutece.plugins.cgu.service.ICguService` expose des m&eacute;thodes permettant de g&eacute;rer les CGU par les autres plugins Lutece :
 
*  `findLastVersion( String strCguCode )` : permet de retrouver la derni&egrave;re version de la CGU dont le code `strCguCode` est pass&eacute; en param&egrave;tre.
*  `acceptCgu( String strCguCode, int nIdResource, String strResourceType )` : indique au *plugin-cgu* que la CGU dont le code est `strCguCode` a&eacute;t&eacute; accept&eacute;e pour la ressource dont le type est `strResourceType` et l'id est `nIdResource` . La ressource est propre au plugin Lutece utilisant ce service.
*  `hasAcceptedLastVersion( String strCguCode, int nIdResource, String strResourceType )` : teste si la ressource dont le type est `strResourceType` et l'id est `nIdResource` a accept&eacute; la derni&egrave;re version de la CGU dont le code est `strCguCode` . La ressource est propre au plugin Lutece utilisant ce service. Cela peut&ecirc;tre utile lorsqu'une nouvelle version de la CGU a&eacute;t&eacute; publi&eacute;e. Il faut alors que la ressource accepte cette nouvelle version.


Ce service est impl&eacute;ment&eacute; par la classe `fr.paris.lutece.plugins.cgu.service.CguService` .

L'objet `fr.paris.lutece.plugins.cgu.business.CguVersion` repr&eacute;sente une version d'une CGU. Cet objet contient l'id de la CGU associ&eacute;e, l'id, le texte et le num&eacute;ro de version de la version de la CGU, si la version est publi&eacute;e ou non et l'&acirc;ge minimum d'acceptation de la CGU.

L'objet `fr.paris.lutece.plugins.cgu.business.AcceptedCgu` repr&eacute;sente la CGU accept&eacute;e par une ressource. Cet objet contient l'id et le type de la ressource et l'id de la derni&egrave;re version accept&eacute;e de la CGU par cette ressource. L'id de la derni&egrave;re version accept&eacute;e de la CGU est l'id d'un objet `fr.paris.lutece.plugins.cgu.business.CguVersion` .

## Usage

Ce plugin s'utilise&agrave; travers les services expos&eacute;s.


[Maven documentation and reports](https://dev.lutece.paris.fr/plugins/plugin-cgu/)



 *generated by [xdoc2md](https://github.com/lutece-platform/tools-maven-xdoc2md-plugin) - do not edit directly.*